<?xml version="1.0" encoding="UTF-8" standalone="no"?><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" contentStyleType="text/css" height="1211px" preserveAspectRatio="none" style="width:1734px;height:1211px;background:#FFFFFF;" version="1.1" viewBox="0 0 1734 1211" width="1734px" zoomAndPan="magnify"><defs/><g><rect fill="none" height="26.4883" id="_title" style="stroke:none;stroke-width:1.0;" width="199" x="763.75" y="10"/><text fill="#000000" font-family="sans-serif" font-size="14" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="189" x="768.75" y="28.5352">Top up account via PayPal</text><rect fill="#DDDDDD" height="1162.3555" style="stroke:#181818;stroke-width:0.5;" width="330.5" x="217" y="43.4883"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="33" x="365.75" y="56.0566">Bank</text><rect fill="#FFFFFF" height="395.5684" style="stroke:#181818;stroke-width:1.0;" width="10" x="270.5" y="198.3086"/><rect fill="#FFFFFF" height="324.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="270.5" y="784.3184"/><rect fill="#FFFFFF" height="321.6367" style="stroke:#181818;stroke-width:1.0;" width="10" x="491.5" y="227.6191"/><rect fill="#FFFFFF" height="250.1055" style="stroke:#181818;stroke-width:1.0;" width="10" x="491.5" y="828.9395"/><rect fill="#FFFFFF" height="247.7051" style="stroke:#181818;stroke-width:1.0;" width="10" x="924.5" y="272.2402"/><rect fill="#FFFFFF" height="176.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="924.5" y="873.5605"/><rect fill="#FFFFFF" height="86.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="1319.5" y="403.7031"/><rect fill="#FFFFFF" height="102.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="1319.5" y="918.1816"/><rect fill="#FFFFFF" height="73.7988" style="stroke:#181818;stroke-width:1.0;" width="10" x="1556.5" y="681.209"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="38" x2="38" y1="118.9766" y2="1126.3555"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="275" x2="275" y1="118.9766" y2="1126.3555"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="496.5" x2="496.5" y1="118.9766" y2="1126.3555"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="929.5" x2="929.5" y1="118.9766" y2="1126.3555"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1324" x2="1324" y1="118.9766" y2="1126.3555"/><line style="stroke:#181818;stroke-width:0.5;stroke-dasharray:5.0,5.0;" x1="1561.5" x2="1561.5" y1="680.6426" y2="1126.3555"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="5" y="116.0234">End User</text><ellipse cx="38.5" cy="50.9883" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38.5,58.9883 L38.5,85.9883 M25.5,66.9883 L51.5,66.9883 M38.5,85.9883 L25.5,100.9883 M38.5,85.9883 L51.5,100.9883 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="61" x="5" y="1138.8906">End User</text><ellipse cx="38.5" cy="1150.3438" fill="#E2E2F0" rx="8" ry="8" style="stroke:#181818;stroke-width:0.5;"/><path d="M38.5,1158.3438 L38.5,1185.3438 M25.5,1166.3438 L51.5,1166.3438 M38.5,1185.3438 L25.5,1200.3438 M38.5,1185.3438 L51.5,1200.3438 " fill="none" style="stroke:#181818;stroke-width:0.5;"/><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="221" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="228" y="108.0234">User Interface</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="109" x="221" y="1125.3555"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="95" x="228" y="1145.8906">User Interface</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="449.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="456.5" y="108.0234">Bank Server</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="94" x="449.5" y="1125.3555"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="80" x="456.5" y="1145.8906">Bank Server</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="862.5" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="869.5" y="108.0234">Payment Platform</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="134" x="862.5" y="1125.3555"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="120" x="869.5" y="1145.8906">Payment Platform</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="135" x="1257" y="87.4883"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="1264" y="108.0234">PayPal Processing</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="135" x="1257" y="1125.3555"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="121" x="1264" y="1145.8906">PayPal Processing</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="146" x="1488.5" y="1125.3555"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132" x="1495.5" y="1145.8906">Authorization Page</text><rect fill="#FFFFFF" height="395.5684" style="stroke:#181818;stroke-width:1.0;" width="10" x="270.5" y="198.3086"/><rect fill="#FFFFFF" height="324.0371" style="stroke:#181818;stroke-width:1.0;" width="10" x="270.5" y="784.3184"/><rect fill="#FFFFFF" height="321.6367" style="stroke:#181818;stroke-width:1.0;" width="10" x="491.5" y="227.6191"/><rect fill="#FFFFFF" height="250.1055" style="stroke:#181818;stroke-width:1.0;" width="10" x="491.5" y="828.9395"/><rect fill="#FFFFFF" height="247.7051" style="stroke:#181818;stroke-width:1.0;" width="10" x="924.5" y="272.2402"/><rect fill="#FFFFFF" height="176.1738" style="stroke:#181818;stroke-width:1.0;" width="10" x="924.5" y="873.5605"/><rect fill="#FFFFFF" height="86.9316" style="stroke:#181818;stroke-width:1.0;" width="10" x="1319.5" y="403.7031"/><rect fill="#FFFFFF" height="102.2422" style="stroke:#181818;stroke-width:1.0;" width="10" x="1319.5" y="918.1816"/><rect fill="#FFFFFF" height="73.7988" style="stroke:#181818;stroke-width:1.0;" width="10" x="1556.5" y="681.209"/><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1727.5" x="0" y="151.9873"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1727.5" y1="151.9873" y2="151.9873"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1727.5" y1="154.9873" y2="154.9873"/><rect fill="#EEEEEE" height="28.0215" style="stroke:#000000;stroke-width:2.0;" width="151" x="788.25" y="138.9766"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="137" x="794.25" y="159.4121">Create Payment</text><polygon fill="#181818" points="258.5,194.3086,268.5,198.3086,258.5,202.3086,262.5,198.3086" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38.5" x2="264.5" y1="198.3086" y2="198.3086"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="45.5" y="193.5664">01:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="160" x="70.5" y="193.5664">top up account via PayPal</text><polygon fill="#181818" points="479.5,223.6191,489.5,227.6191,479.5,231.6191,483.5,227.6191" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="280.5" x2="485.5" y1="227.6191" y2="227.6191"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="287.5" y="222.877">02:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="167" x="312.5" y="222.877">request to create the order</text><polygon fill="#181818" points="912.5,268.2402,922.5,272.2402,912.5,276.2402,916.5,272.2402" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="501.5" x2="918.5" y1="272.2402" y2="272.2402"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="508.5" y="259.8428">03:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="204" x="533.5" y="252.1875">POST /v1/transaction/payments</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="202" x="533.5" y="267.498">//request to create the payment</text><rect fill="none" height="81.8418" style="stroke:#000000;stroke-width:1.5;" width="535.5" x="859.5" y="280.2402"/><path d="M859.5,280.2402 L923.5,280.2402 L923.5,287.2402 L913.5,297.2402 L859.5,297.2402 L859.5,280.2402 " fill="#EEEEEE" style="stroke:#000000;stroke-width:2.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="19" x="872.5" y="294.8086">ref</text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1125.25" y="312.8418"> </text><a href="https://gitlab.com/kuziomkin/case_study_excercise_form3/-/blob/main/out/authorize_consumer_sequence/authorize_consumer.svg" target="_top" title="Tooltip for message" xlink:actuate="onRequest" xlink:href="https://gitlab.com/kuziomkin/case_study_excercise_form3/-/blob/main/out/authorize_consumer_sequence/authorize_consumer.svg" xlink:show="new" xlink:title="Tooltip for message" xlink:type="simple"><text fill="#0000FF" font-family="sans-serif" font-size="12" font-weight="bold" lengthAdjust="spacing" text-decoration="underline" textLength="141" x="1056.75" y="326.9746">Generate access_token</text></a><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1125.25" y="341.1074"> </text><text fill="#000000" font-family="sans-serif" font-size="12" lengthAdjust="spacing" textLength="4" x="1125.25" y="355.2402"> </text><polygon fill="#181818" points="1307.5,399.7031,1317.5,403.7031,1307.5,407.7031,1311.5,403.7031" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="934.5" x2="1313.5" y1="403.7031" y2="403.7031"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="941.5" y="391.3057">04:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="170" x="966.5" y="383.6504">POST /v2/checkout/orders</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="181" x="966.5" y="398.9609">//request to create the order</text><line style="stroke:#181818;stroke-width:1.0;" x1="1329.5" x2="1371.5" y1="433.0137" y2="433.0137"/><line style="stroke:#181818;stroke-width:1.0;" x1="1371.5" x2="1371.5" y1="433.0137" y2="446.0137"/><line style="stroke:#181818;stroke-width:1.0;" x1="1330.5" x2="1371.5" y1="446.0137" y2="446.0137"/><polygon fill="#181818" points="1340.5,442.0137,1330.5,446.0137,1340.5,450.0137,1336.5,446.0137" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="1336.5" y="428.2715">05:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="75" x="1361.5" y="428.2715">create order</text><polygon fill="#181818" points="945.5,486.6348,935.5,490.6348,945.5,494.6348,941.5,490.6348" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="939.5" x2="1323.5" y1="490.6348" y2="490.6348"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="951.5" y="478.2373">06:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="976.5" y="470.582">HTTP 201 Created</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="336" x="976.5" y="485.8926">(id, intent, status, purchase_units, create_time, links)</text><polygon fill="#181818" points="512.5,515.9453,502.5,519.9453,512.5,523.9453,508.5,519.9453" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="506.5" x2="928.5" y1="519.9453" y2="519.9453"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="518.5" y="515.2031">07:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="543.5" y="515.2031">HTTP 201 Created (data)</text><polygon fill="#181818" points="291.5,545.2559,281.5,549.2559,291.5,553.2559,287.5,549.2559" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="285.5" x2="495.5" y1="549.2559" y2="549.2559"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="297.5" y="544.5137">08:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="139" x="322.5" y="544.5137">result (id, status, link)</text><polygon fill="#181818" points="49.5,589.877,39.5,593.877,49.5,597.877,45.5,593.877" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43.5" x2="274.5" y1="593.877" y2="593.877"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="55.5" y="581.4795">09:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="80" x="80.5" y="573.8242">redirect User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="179" x="84.5" y="589.1348">to PayPal Authorization Page</text><rect fill="#EEEEEE" height="3" style="stroke:#EEEEEE;stroke-width:1.0;" width="1727.5" x="0" y="624.8877"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1727.5" y1="624.8877" y2="624.8877"/><line style="stroke:#000000;stroke-width:1.0;" x1="0" x2="1727.5" y1="627.8877" y2="627.8877"/><rect fill="#EEEEEE" height="28.0215" style="stroke:#000000;stroke-width:2.0;" width="155" x="786.25" y="611.877"/><text fill="#000000" font-family="sans-serif" font-size="17" font-weight="bold" lengthAdjust="spacing" textLength="141" x="792.25" y="632.3125">Submit Payment</text><polygon fill="#181818" points="1476.5,667.209,1486.5,671.209,1476.5,675.209,1480.5,671.209" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38.5" x2="1482.5" y1="671.209" y2="671.209"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="45.5" y="666.4668">10:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="176" x="70.5" y="666.4668">authorize payment for order</text><rect fill="#E2E2F0" height="30.4883" rx="2.5" ry="2.5" style="stroke:#181818;stroke-width:0.5;" width="146" x="1488.5" y="649.8984"/><text fill="#000000" font-family="sans-serif" font-size="14" lengthAdjust="spacing" textLength="132" x="1495.5" y="670.4336">Authorization Page</text><line style="stroke:#181818;stroke-width:1.0;" x1="1566.5" x2="1608.5" y1="712.6973" y2="712.6973"/><line style="stroke:#181818;stroke-width:1.0;" x1="1608.5" x2="1608.5" y1="712.6973" y2="725.6973"/><line style="stroke:#181818;stroke-width:1.0;" x1="1567.5" x2="1608.5" y1="725.6973" y2="725.6973"/><polygon fill="#181818" points="1577.5,721.6973,1567.5,725.6973,1577.5,729.6973,1573.5,725.6973" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="1573.5" y="707.9551">11:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="117" x="1598.5" y="707.9551">authorize payment</text><polygon fill="#181818" points="49.5,751.0078,39.5,755.0078,49.5,759.0078,45.5,755.0078" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43.5" x2="1560.5" y1="755.0078" y2="755.0078"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="55.5" y="750.2656">12:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="190" x="80.5" y="750.2656">redirect back to User Interface</text><polygon fill="#181818" points="258.5,780.3184,268.5,784.3184,258.5,788.3184,262.5,784.3184" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="38.5" x2="264.5" y1="784.3184" y2="784.3184"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="45.5" y="779.5762">13:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="156" x="70.5" y="779.5762">is waiting for processing</text><polygon fill="#181818" points="479.5,824.9395,489.5,828.9395,479.5,832.9395,483.5,828.9395" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="280.5" x2="485.5" y1="828.9395" y2="828.9395"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="287.5" y="816.542">14:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="115" x="312.5" y="808.8867">request to capture</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="312.5" y="824.1973">payment for order</text><polygon fill="#181818" points="912.5,869.5605,922.5,873.5605,912.5,877.5605,916.5,873.5605" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="501.5" x2="918.5" y1="873.5605" y2="873.5605"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="508.5" y="861.1631">15:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="379" x="533.5" y="853.5078">POST /v1/transaction/payments/{payment_id}/submissions</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="195" x="533.5" y="868.8184">//request to submit a payment</text><polygon fill="#181818" points="1307.5,914.1816,1317.5,918.1816,1307.5,922.1816,1311.5,918.1816" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="934.5" x2="1313.5" y1="918.1816" y2="918.1816"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="941.5" y="905.7842">16:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="287" x="966.5" y="898.1289">POST /v2/checkout/orders/:order_id/capture</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="246" x="966.5" y="913.4395">//request to capture payment for order</text><line style="stroke:#181818;stroke-width:1.0;" x1="1329.5" x2="1371.5" y1="962.8027" y2="962.8027"/><line style="stroke:#181818;stroke-width:1.0;" x1="1371.5" x2="1371.5" y1="962.8027" y2="975.8027"/><line style="stroke:#181818;stroke-width:1.0;" x1="1330.5" x2="1371.5" y1="975.8027" y2="975.8027"/><polygon fill="#181818" points="1340.5,971.8027,1330.5,975.8027,1340.5,979.8027,1336.5,975.8027" style="stroke:#181818;stroke-width:1.0;"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="1336.5" y="950.4053">17:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="188" x="1361.5" y="942.75">transfer money from End User</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="1361.5" y="958.0605">to Bank PayPal account</text><polygon fill="#181818" points="945.5,1016.4238,935.5,1020.4238,945.5,1024.4238,941.5,1020.4238" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;" x1="939.5" x2="1323.5" y1="1020.4238" y2="1020.4238"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="951.5" y="1008.0264">18:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="113" x="976.5" y="1000.3711">HTTP 201 Created</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="336" x="976.5" y="1015.6816">(id, intent, status, purchase_units, create_time, links)</text><polygon fill="#181818" points="512.5,1045.7344,502.5,1049.7344,512.5,1053.7344,508.5,1049.7344" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="506.5" x2="928.5" y1="1049.7344" y2="1049.7344"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="518.5" y="1044.9922">19:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="152" x="543.5" y="1044.9922">HTTP 201 Created (data)</text><polygon fill="#181818" points="291.5,1075.0449,281.5,1079.0449,291.5,1083.0449,287.5,1079.0449" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="285.5" x2="495.5" y1="1079.0449" y2="1079.0449"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="297.5" y="1074.3027">20:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="107" x="322.5" y="1074.3027">result (id, status)</text><polygon fill="#181818" points="49.5,1104.3555,39.5,1108.3555,49.5,1112.3555,45.5,1108.3555" style="stroke:#181818;stroke-width:1.0;"/><line style="stroke:#181818;stroke-width:1.0;stroke-dasharray:2.0,2.0;" x1="43.5" x2="274.5" y1="1108.3555" y2="1108.3555"/><text fill="#000000" font-family="sans-serif" font-size="13" font-weight="bold" lengthAdjust="spacing" textLength="21" x="55.5" y="1103.6133">21:</text><text fill="#000000" font-family="sans-serif" font-size="13" lengthAdjust="spacing" textLength="144" x="80.5" y="1103.6133">render operation result</text><!--MD5=[8986b4b92153ef200bf80c15ee827578]
@startuml top_up_account_via_paypal
title __Top up account via PayPal__
actor "End User" as EU
box "Bank"
participant "User Interface" as UI
participant "Bank Server"  as BS 
end box
participant "Payment Platform" as PP 
participant "PayPal Processing" as PaP


autonumber "<b>00:"
/'
        Create Order
'/
===Create Payment==
EU -> UI : top up account via PayPal
    activate UI
        UI -> BS : request to create the order
            activate BS
                BS -> PP : POST /v1/transaction/payments\n//request to create the payment
                    activate PP
ref over PP, PaP

                                                **[[https://gitlab.com/kuziomkin/case_study_excercise_form3/-/blob/main/out/authorize_consumer_sequence/authorize_consumer.svg{Tooltip for message} Generate access_token]]**


end ref     
                        PP -> PaP : POST /v2/checkout/orders\n//request to create the order
                            activate PaP
                                PaP -> PaP : create order
                                PaP - -> PP : HTTP 201 Created\n(id, intent, status, purchase_units, create_time, links)
                            deactivate PaP
                        PP - -> BS : HTTP 201 Created (data)
                    deactivate PP
                BS - -> UI : result (id, status, link)
            deactivate BS
        UI - -> EU : redirect User\n to PayPal Authorization Page
    deactivate UI
/'
        Capture payment for order
'/
===Submit Payment==

EU -> "Authorization Page" ** : authorize payment for order
    activate "Authorization Page"
        "Authorization Page" -> "Authorization Page" : authorize payment
        "Authorization Page" - -> EU : redirect back to User Interface
    deactivate "Authorization Page"
EU -> UI : is waiting for processing
    activate UI
        UI -> BS : request to capture\npayment for order
            activate BS
                BS -> PP : POST /v1/transaction/payments/{payment_id}/submissions\n//request to submit a payment
                    activate PP
                        PP -> PaP : POST /v2/checkout/orders/:order_id/capture\n//request to capture payment for order
                            activate PaP
                                PaP -> PaP : transfer money from End User\nto Bank PayPal account
                                PaP -> PP : HTTP 201 Created\n(id, intent, status, purchase_units, create_time, links)
                            deactivate PaP
                        PP - -> BS : HTTP 201 Created (data)
                    deactivate PP
                BS - -> UI : result (id, status)
            deactivate BS
        UI - -> EU : render operation result
    deactivate UI
@enduml             

@startuml top_up_account_via_paypal
title __Top up account via PayPal__
actor "End User" as EU
box "Bank"
participant "User Interface" as UI
participant "Bank Server"  as BS 
end box
participant "Payment Platform" as PP 
participant "PayPal Processing" as PaP


autonumber "<b>00:"
===Create Payment==
EU -> UI : top up account via PayPal
    activate UI
        UI -> BS : request to create the order
            activate BS
                BS -> PP : POST /v1/transaction/payments\n//request to create the payment
                    activate PP
ref over PP, PaP

                                                **[[https://gitlab.com/kuziomkin/case_study_excercise_form3/-/blob/main/out/authorize_consumer_sequence/authorize_consumer.svg{Tooltip for message} Generate access_token]]**


end ref     
                        PP -> PaP : POST /v2/checkout/orders\n//request to create the order
                            activate PaP
                                PaP -> PaP : create order
                                PaP - -> PP : HTTP 201 Created\n(id, intent, status, purchase_units, create_time, links)
                            deactivate PaP
                        PP - -> BS : HTTP 201 Created (data)
                    deactivate PP
                BS - -> UI : result (id, status, link)
            deactivate BS
        UI - -> EU : redirect User\n to PayPal Authorization Page
    deactivate UI
===Submit Payment==

EU -> "Authorization Page" ** : authorize payment for order
    activate "Authorization Page"
        "Authorization Page" -> "Authorization Page" : authorize payment
        "Authorization Page" - -> EU : redirect back to User Interface
    deactivate "Authorization Page"
EU -> UI : is waiting for processing
    activate UI
        UI -> BS : request to capture\npayment for order
            activate BS
                BS -> PP : POST /v1/transaction/payments/{payment_id}/submissions\n//request to submit a payment
                    activate PP
                        PP -> PaP : POST /v2/checkout/orders/:order_id/capture\n//request to capture payment for order
                            activate PaP
                                PaP -> PaP : transfer money from End User\nto Bank PayPal account
                                PaP -> PP : HTTP 201 Created\n(id, intent, status, purchase_units, create_time, links)
                            deactivate PaP
                        PP - -> BS : HTTP 201 Created (data)
                    deactivate PP
                BS - -> UI : result (id, status)
            deactivate BS
        UI - -> EU : render operation result
    deactivate UI
@enduml             

PlantUML version 1.2022.7(Mon Aug 22 19:01:30 CEST 2022)
(GPL source distribution)
Java Runtime: Java(TM) SE Runtime Environment
JVM: Java HotSpot(TM) 64-Bit Server VM
Default Encoding: UTF-8
Language: en
Country: RU
--></g></svg>